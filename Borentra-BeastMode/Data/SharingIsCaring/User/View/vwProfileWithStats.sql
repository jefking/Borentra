CREATE VIEW [User].[vwProfileWithStats]
AS
	SELECT [Profile].[UserIdentifier]
		, [Profile].[DisplayName]
		, [Profile].[FacebookId]
		, [Profile].[Status]
		, [Profile].[Key]
		, [Profile].[Location]
		, [Profile].[CreatedOn]
		, [Profile].[PrivacyLevel]
		, [Profile].[GeoLocation]
		, [Profile].[GeoLocation].Lat AS [Latitude]
		, [Profile].[GeoLocation].Long AS [Longitude]
		, [Profile].[SearchRadius]
		, [Profile].[Email]
		, [Profile].[FacebookAccessToken]
		, [Profile].[FacebookTokenExpiration]
		, [stats].[BorrowCount]
		, [stats].[LendCount]
		, [stats].[RecieveCount]
		, [stats].[GiveCount]
		, [stats].[ItemCount]
		, [stats].[ItemRequestCount]
		, [stats].[TradeCount]
		, [stats].[FriendCount]
		, [stats].[MembersNearby]
		, [stats].[Points]
		, [stats].[FriendsOffersCount]
	FROM [User].[vwProfile] [profile] WITH (NOLOCK)
		LEFT OUTER JOIN [User].[vwProfileStats] [stats] WITH (NOLOCK)
			ON [Profile].[UserIdentifier] = [stats].[UserIdentifier]